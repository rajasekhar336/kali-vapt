import json
from vulnerability_classifier import classify_vulnerability


def test_csp_detection():
    res = classify_vulnerability('zap', 'CSP: script-src unsafe-inline', 'example.com')
    assert res['issue_type'] == 'csp_violation'


def test_sql_injection_detection():
    res = classify_vulnerability('sqlmap', "Parameter 'id' is vulnerable to SQL injection", 'example.com')
    assert res['issue_type'] == 'sql_injection'


def test_xss_detection():
    res = classify_vulnerability('zap', '<script>alert(1)</script>', 'example.com')
    assert 'xss' in res['issue_type'] or res['issue_type'] == 'xss_reflected'
